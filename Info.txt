API REST em PHP estruturada em MVC com camadas, que implementa CRUD para tr√™s entidades: Aplicativo, Usu√°rio e Ve√≠culo.

üóÇ Estrutura

routes ‚Üí define rotas HTTP

controllers ‚Üí l√≥gica de neg√≥cio

models ‚Üí entidades do sistema

DAO ‚Üí acesso ao banco

middlewares ‚Üí valida√ß√µes e autentica√ß√£o (inclui JWT)

http ‚Üí respostas padronizadas JSON

db ‚Üí conex√£o

utils ‚Üí helpers, logs, tokens

üîÑ Fluxo

Requisi√ß√£o HTTP ‚Üí Router ‚Üí Middleware (valida√ß√µes) ‚Üí Controller (l√≥gica) ‚Üí DAO (banco) ‚Üí Response (JSON)

üèó Principais componentes

Router ‚Üí gerencia rotas (CRUD + exporta√ß√£o/importa√ß√£o)

Controllers ‚Üí orquestram l√≥gica e chamam DAO

Middlewares ‚Üí validam dados (e-mail, senha, duplicidade, JWT etc.)

Models ‚Üí estruturas das entidades

DAOs ‚Üí CRUD no banco com integridade

Response ‚Üí formato √∫nico de sa√≠da

Utils ‚Üí JWT e logger

‚öôÔ∏è Recursos T√©cnicos

Padr√µes: MVC, REST, DAO, Middleware

Seguran√ßa: JWT, CORS, senhas com hash, valida√ß√µes fortes

Extras: Pagina√ß√£o, exporta√ß√£o/importa√ß√£o (CSV/JSON/XML), logs, erros padronizados

üìä Banco de Dados

Usu√°rio ‚Üí Aplicativo (N:1)

Ve√≠culo ‚Üí Aplicativo (N:1)

üöÄ Pontos fortes

C√≥digo organizado em camadas

Valida√ß√µes robustas em v√°rias etapas

Tratamento de erros consistente

Flexibilidade de entrada/sa√≠da (JSON, CSV, XML)

üõ† Analogia do fluxo

Middleware ‚Üí checa qualidade da entrada (dados crus)

Controller ‚Üí monta o objeto final e coordena regras de neg√≥cio

DAO ‚Üí salva e garante integridade no banco

api/
  src/
    controllers/
      AplicativoControl.php
      UsuarioControl.php
      VeiculoControl.php
    DAO/
      AplicativoDAO.php
      UsuarioDAO.php
      VeiculoDAO.php
    db/
      Database.php                
    http/
      Response.php
    middlewares/
      AplicativoMiddleware.php
      UsuarioMiddleware.php
      VeiculoMiddleware.php
      AuthMiddleware.php
    models/
      Aplicativo.php
      Usuario.php
      Veiculo.php
    routes/
      aplicativoRoutes.php
      usuarioRoutes.php
      veiculoRoutes.php
    utils/
      JwtHelper.php
      Logger.php
üìå Explica√ß√£o r√°pida de cada pasta:

controllers ‚Üí l√≥gica de neg√≥cio e chamadas aos DAO

DAO ‚Üí CRUD no banco

db ‚Üí conex√£o com MySQL (XAMPP)

http ‚Üí resposta padronizada JSON

middlewares ‚Üí valida√ß√µes + autentica√ß√£o (ex: JWT)

models ‚Üí defini√ß√£o das entidades

routes ‚Üí rotas HTTP (GET, POST, PUT, DELETE)

utils ‚Üí helpers (JWT, logs, etc.)


Exemplo de INPUTS JSON:
POST: 
{
  "aplicativo": {
    "nomeAplicativo": "Meu Novo App",
    "nomeEmpresa": "Minha Empresa LTDA"
  }
}

{
  "usuario": {
    "nomeUsuario": "Carlos Santos",
    "email": "carlos@email.com",
    "senha": "senhaSegura123",
    "maiorIdade": true,
    "aplicativo_idAplicativo": 1
  }
}

{
  "veiculo": {
    "nomeVeiculo": "Fusca Azul",
    "usado": true,
    "aplicativo_idAplicativo": 1
  }
}

PUT:

{
  "aplicativo": {
    "nomeAplicativo": "Uber Atualizado",
    "nomeEmpresa": "Uber Technologies Inc."
  }
}

{
  "usuario": {
    "nomeUsuario": "Jo√£o Silva Santos",
    "email": "joao.novo@email.com",
    "senha": "novaSenha456",
    "maiorIdade": true,
    "aplicativo_idAplicativo": 2
  }
}

{
  "veiculo": {
    "nomeVeiculo": "Toyota Corolla Novo",
    "usado": false,
    "aplicativo_idAplicativo": 3
  }
}



üîê Autentica√ß√£o
Login
POST /login
Autentica um usu√°rio e retorna um token JWT.
Headers:
Content-Type: application/json
Body:
json{
  "usuario": {
    "email": "usuario@email.com",
    "senha": "suasenha123"
  }
}
Resposta de Sucesso (200):
json{
  "success": true,
  "message": "Login realizado com sucesso",
  "data": {
    "token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...",
    "usuario": {
      "idUsuario": 1,
      "nomeUsuario": "Jo√£o Silva",
      "email": "usuario@email.com",
      "role": "admin",
      "idAplicativo": 1
    },
    "expira_em": "2024-09-25 15:30:00"
  },
  "error": []
}
Resposta de Erro (401):
json{
  "success": false,
  "message": "Email ou senha inv√°lidos",
  "data": [],
  "error": {
    "code": "auth_error",
    "message": "Credenciais de autentica√ß√£o inv√°lidas"
  }
}

üõ†Ô∏è Utilit√°rios
Reset Database
POST /reset-database ou GET /reset-database
Reseta o banco de dados (√∫til para desenvolvimento).

üéØ Aplicativos

Todas as rotas de aplicativos requerem autentica√ß√£o JWT no header Authorization: Bearer {token}

Listar Aplicativos
GET /aplicativos
Headers:
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...
Buscar Aplicativo por ID
GET /aplicativos/{id}
Exemplo: GET /aplicativos/1
Criar Aplicativo
POST /aplicativos
Headers:
Content-Type: application/json
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...
Body:
json{
  "aplicativo": {
    "nomeAplicativo": "Meu App Mobile"
  }
}
Atualizar Aplicativo
PUT /aplicativos/{id}
Headers:
Content-Type: application/json
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...
Body:
json{
  "aplicativo": {
    "nomeAplicativo": "App Mobile Atualizado"
  }
}
Excluir Aplicativo
DELETE /aplicativos/{id}
Headers:
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...

üë• Usu√°rios

Todas as rotas de usu√°rios requerem autentica√ß√£o JWT no header Authorization: Bearer {token}

Listar Usu√°rios
GET /usuarios
Headers:
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...
Buscar Usu√°rio por ID
GET /usuarios/{id}
Exemplo: GET /usuarios/1
Criar Usu√°rio
POST /usuarios
Headers:
Content-Type: application/json
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...
Body:
json{
  "usuario": {
    "nomeUsuario": "Jo√£o Silva",
    "email": "joao@email.com",
    "senha": "senha123",
    "maiorIdade": true,
    "aplicativo_idAplicativo": 1
  }
}
Atualizar Usu√°rio
PUT /usuarios/{id}
Headers:
Content-Type: application/json
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...
Body:
json{
  "usuario": {
    "nomeUsuario": "Jo√£o Silva Santos",
    "email": "joao.santos@email.com",
    "senha": "novasenha123",
    "maiorIdade": true,
    "aplicativo_idAplicativo": 1
  }
}
Nota: O campo senha √© opcional na atualiza√ß√£o. Se n√£o enviado, a senha n√£o ser√° alterada.
Excluir Usu√°rio
DELETE /usuarios/{id}
Headers:
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...

üöó Ve√≠culos

Todas as rotas de ve√≠culos requerem autentica√ß√£o JWT no header Authorization: Bearer {token}

Listar Ve√≠culos
GET /veiculos
Headers:
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...
Buscar Ve√≠culo por ID
GET /veiculos/{id}
Exemplo: GET /veiculos/1
Criar Ve√≠culo
POST /veiculos
Headers:
Content-Type: application/json
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...
Body:
json{
  "veiculo": {
    "nomeVeiculo": "Honda Civic 2020",
    "usado": false,
    "aplicativo_idAplicativo": 1
  }
}
Atualizar Ve√≠culo
PUT /veiculos/{id}
Headers:
Content-Type: application/json
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...
Body:
json{
  "veiculo": {
    "nomeVeiculo": "Honda Civic 2020 - Seminovo",
    "usado": true,
    "aplicativo_idAplicativo": 1
  }
}
Excluir Ve√≠culo
DELETE /veiculos/{id}
Headers:
Authorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...

üìù Observa√ß√µes Importantes

Autentica√ß√£o: Todas as rotas exceto /login e /reset-database requerem token JWT.
Headers obrigat√≥rios para rotas protegidas:
Authorization: Bearer {seu_token_jwt}

Headers para requisi√ß√µes com body:
Content-Type: application/json

Token JWT: Ap√≥s fazer login, use o token retornado no campo data.token para autenticar as demais requisi√ß√µes.
Estrutura de resposta padr√£o:
json{
  "success": true/false,
  "message": "Mensagem descritiva",
  "data": {}, // Dados retornados
  "error": {} // Detalhes do erro (quando success = false)
}

C√≥digos HTTP comuns:

200: Sucesso
400: Dados inv√°lidos
401: N√£o autorizado (token inv√°lido/ausente)
404: Recurso n√£o encontrado
409: Conflito (email/nome j√° existe)
500: Erro interno do servidor


